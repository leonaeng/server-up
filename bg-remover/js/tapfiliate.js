!function(){var t=window,n=window.TapfiliateObject||"tap",e=t[n]&&t[n].q||[];if(!t[n]||!t[n].loaded){var o,i;t[n]=function(e,o,i,r,a,c){var s=t[n][e];if("function"!=typeof s)throw'Function "'+e+'" not supported';s(o,i,r,a,c)},t[n].q=e,t[n].loaded=!0,t[n].baseUrl="https://frstre.com",t[n].baseUrlDepr="https://tapi.tapfiliate.com",t[n].Tracking=t[n].Tracking||{},t[n].options=t[n].options||{};var r={},a=!1,c=function(t){var n,e,o,i,r;if(e=[],r=/%20/g,o=function(t,n){n="function"==typeof n?n():null===n?"":n,e[e.length]=encodeURIComponent(t)+"="+encodeURIComponent(n)},t instanceof Array)for(i in t)o(i,t[i]);else for(n in t)v(n,t[n],o);return e.join("&").replace(r,"+")},s=new function(){var t={},n=0,e=[],o=[],i=!1,r=this;return this.addMethod=function(e){if(e.supported())return n++,t[e.key]=e,this},this.init=function(){var a=n;function c(){--a<=0&&(i=!0,function(){for(var t=e.length-1;0<=t;t--)r.read.apply(r,e[t]);for(var n=o.length-1;0<=n;n--)r.write.apply(r,o[n])}())}for(var s in t)"function"==typeof t[s].init?t[s].init(c):c()},this.read=function(o,r,a){if(i){var c=n,s=[],l={};for(var u in t){l[u]=setTimeout(p,2e3);try{t[u].read(o,p)}catch(o){}}}else e.push(arguments);function p(t,n,e){clearTimeout(l[e]),n&&n.constructor===Array?s=s.concat(n):s.push(n),0==--c&&a(null,s)}},this.write=function(e,r,a,c){i||o.push(arguments);var s=n;function l(t,n){0==--s&&"function"==typeof c&&c()}for(var u in t)t[u].write(e,r,a,l)},this.hasMethod=function(n){return void 0!==t[n]},this};b.prototype.supported=function(){return!0};var l=new b("1pCookie");l.read=function(t,n){for(var e=t+"=",o=document.cookie.split(";"),i=[],r=0;r<o.length;r++){var a=o[r].replace(/^\s+|\s+$/g,"");0===a.indexOf(e)&&i.push(a.substring(e.length,a.length))}return"function"==typeof n?n(null,i,this.key):i},l.write=function(t,n,e,o){e=e||{};var i=new Date;i.setTime(i.getTime()+31536e6);var r,a="expires="+i.toGMTString();if(e.cookie_domain)r="."+e.cookie_domain;else try{var c=window.location.href.match(/(?:https?:\/\/)?(?:www\.)?(.*?)\//);r="."+c[c.length-1]}catch(t){}var s=t+"="+n+"; "+a+"; path=/";s+=void 0!==r?"; domain="+r:"",document.cookie=s,o()};var u=new b("localStorage");u.supported=function(){return"undefined"!=typeof localStorage},u.read=function(t,n){n(null,localStorage.getItem(t),this.key)},u.write=function(t,n,e,o){o(null,localStorage.setItem(t,n))},(w.prototype=new b).supported=function(){return"undefined"!=typeof postMessage},w.prototype.handleEvent=function(t){if(t.origin===this.options.url){var n;try{n=JSON.parse(t.data)}catch(t){}n&&n.callback&&this.callbacks[n.callback](n.value)}},w.prototype.init=function(t){var n=document.createElement("IFRAME");n.setAttribute("src",this.options.url+"/?"+this.options.beaconVersion),n.style.width="1px",n.style.height="1px",n.style.display="none",d(window,"message",this);var e=this;d(n,"load",(function(){e.beacon=n.contentWindow,t()})),setTimeout((function(){document.body.appendChild(n)}),0)},w.prototype.post=function(t){this.beacon.postMessage(t,this.options.url)},w.prototype.read=function(t,n){var e=this;this.callbacks.get=function(t){n(null,t,e.key)};var o={action:"getAll",key:t};this.post(JSON.stringify(o))},w.prototype.write=function(t,n,e,o){this.callbacks.set=function(t){o(null,t)};var i={action:"set",key:t,value:n};this.post(JSON.stringify(i))},t[n].Create=t[n].Create||{},t[n].Create.calls=t[n].Create.calls||[],t[n].Click=t[n].Click||{},t[n].Click.q=t[n].Click.q||[],t[n].Click.calls=t[n].Click.calls||[],t[n].Click.track=function(e,o,a,c){if(window.self===window.top){var s,l,u,p;if(null===(a=a||{}).referral_code_param&&void 0===a.referral_code||(s=a.referral_code,p=a.referral_code_param,l=(u=s)||0===u?u:(p=p||"ref",m()[p])),t[n].Click.calls.push(a),!(e&&o||l))return _("No tracking parameters",a,c);var f=m(),d=null;for(var v in f)"tm_"===v.slice(0,3)&&((d=d||{})[v.slice(3,v.length)]=f[v]);var h={data:{acc:i,aid:e,sid:o,callback:c,options:a,pm:d,ref:document.referrer||null,cup:document.location.href||null,int:r.integration||null}};l&&(h.data.refc=l),t[n].Click.q.push(h),y()}},t[n].Click.flushQueue=function(){t[n].Click.q.reverse();for(var e=t[n].Click.q.length-1;0<=e;e--){var o=t[n].Click.q[e].data,i=g();if(o.aid&&o.sid||o.refc){var r={acc:o.acc,aid:o.aid,sid:o.sid,pm:o.pm,ref:o.ref,cup:o.cup,refc:o.refc,int:o.int};i&&s.hasMethod("3pCookie")&&(r.vids=i),h(t[n].baseUrl+"/event/",r,null,(function(t,n){var e=t.response||t.responseText;if(n&&e){var i=JSON.parse(e);if(i.vid)return s.write("tap_vid",i.vid,o.options),C([i.vid]),void("function"==typeof o.callback&&(1==o.options.always_callback?o.callback(null,i):o.callback(i)))}return _("Tracking request failed",o.options,o.callback)}))}t[n].Click.q.splice(e,1)}},t[n].Conversion=t[n].Conversion||{},t[n].Conversion.q=t[n].Conversion.q||[],t[n].Conversion.calls=t[n].Conversion.calls||[],t[n].Conversion.flushQueue=function(){t[n].Conversion.q.reverse();for(var e=t[n].Conversion.q.length-1;0<=e;e--){var o=t[n].Conversion.q[e].data,i=t[n].Conversion.q[e].type,r=void 0!==t[n].Conversion.q[e].vid?t[n].Conversion.q[e].vid:g();if(!(o.acc&&r||o.options.attribution_id||o.options.coupons&&o.options.coupons.length||o.options.customer_id))return _("Non-tracked visitor",o.options,o.callback);var a,c=t[n].baseUrlDepr+"/conversions/";if("single"==i)a={acc:o.acc,vid:r,tid:o.tid,tam:o.tam,options:o.options,ct:o.ct,int:o.int};else{if("multi"!=i)return _("Missing request type",o.options,o.callback);a={acc:o.acc,vid:r,tid:o.tid,options:o.options,com:o.com,int:o.int}}h(c,a,"POST",(function(t,n){if(!n)return _("Conversion denied",o.options,o.callback);var e;try{e=JSON.parse(t.response)}catch(t){return _("Conversion denied",o.options,o.callback)}"function"==typeof o.callback&&(1==o.options.always_callback?o.callback(null,e):o.callback(e,"success"))})),r&&r.length&&t[n].Conversion.q.splice(e,1)}},t[n].Customer=t[n].Customer||{},t[n].Customer.q=t[n].Customer.q||[],t[n].Customer.calls=t[n].Customer.calls||[],t[n].Customer.flushQueue=function(){t[n].Customer.q.reverse();for(var e=t[n].Customer.q.length-1;0<=e;e--){var o=t[n].Customer.q[e].data,i=void 0!==t[n].Customer.q[e].vid?t[n].Customer.q[e].vid:g();if(!(o.acc&&i||o.options.coupons&&o.options.coupons.length))return _("Non-tracked visitor",o.options,o.callback);h(t[n].baseUrlDepr+"/customers/",{acc:o.acc,vid:i,tid:o.tid,options:o.options,sta:o.sta},"POST",(function(t,n){if(!n)return _("Customer denied",o.options,o.callback);var e;try{e=JSON.parse(t.response)}catch(t){return _("Customer denied",o.options,o.callback)}"function"==typeof o.callback&&(1==o.options.always_callback?o.callback(null,e):o.callback(e,"success"))})),i&&i.length&&t[n].Customer.q.splice(e,1)}},t[n].create=function(e,o,a){var c;i=e,c=r=function(){for(var t={},n=0;n<arguments.length;n+=1)for(var e=arguments[n],o=Object.keys(e),i=0;i<o.length;i+=1)t[o[i]]=e[o[i]];return t}(r,o||{}),s.hasMethod("1pcookie")||s.addMethod(l),s.hasMethod("localStorage")||s.addMethod(u),c.include_methods&&-1<c.include_methods.indexOf("3p")&&!s.hasMethod("3pCookie")&&s.addMethod(new w("3pCookie",{url:"https://b.frstre.com",beaconVersion:"v1.4"})),s.init(),s.read("tap_vid",{},(function(t,n){C(n),y(),"function"==typeof a&&a()})),t[n].Create.calls.push({accountId:e,options:o})},t[n].detect=function(e,o){e=e||{},this.urlParams=m();var i=this.urlParams[e.asset_param||"tap_a"],r=this.urlParams[e.source_param||"tap_s"];t[n].Click.track(i,r,e,o)},t[n].click=function(e,o,i){var r=e||{};o=o||{};var a=r.tap_a||r.asset_id,c=r.tap_s||r.source_id;void 0!==r.referral_code&&(o.referral_code=r.referral_code),t[n].Click.track(a,c,o,i)},t[n].conversion=function(e,o,a,c,s){if(window.self===window.top){var l={type:"single",data:{acc:i,tid:e=e||null,tam:o=void 0!==o?o:null,options:a=a||{},ct:c,callback:s,int:r.integration||null}};t[n].Conversion.q.push(l),y(),t[n].Conversion.calls.push({type:"single",tid:e,tam:o,options:a,ct:c})}};var p=function(e,o,a,c){if(window.self===window.top){var s={data:{acc:i,tid:e=e||null,sta:c,options:o=o||{},callback:a,int:r.integration||null}};t[n].Customer.q.push(s),y(),t[n].Customer.calls.push({tid:e,options:o})}};t[n].customer=function(t,n,e){p(t,n,e,"customer")},t[n].trial=function(t,n,e){p(t,n,e,"trial")},t[n].lead=function(t,n,e){p(t,n,e,"lead")},t[n].transactionMulti=function(e,o,i,r){t[n].conversionMulti(e,o,i,r)},t[n].conversionMulti=function(e,o,a,c){var s={type:"multi",data:{acc:i,tid:e,com:a,options:o=o||{},callback:c,int:r.integration||null}};t[n].Conversion.q.push(s),y(),t[n].Conversion.calls.push({type:"multi",tid:e,options:o,com:a})},t[n].getTrackingId=function(t,n){if(s.hasMethod("3pCookie"))throw"getTrackingId not supported with 3rd party cookies enabled";t=t||{};var e=0;!function o(){setTimeout((function(){if(e++,!k())return o();if(!(200<e)){var i=g(),r=null;i&&(r=i.join("__")),"function"==typeof n&&(1==t.always_callback?n(null,r):n(r))}}),100)}()},t[n].detectClick=function(e){t[n].detect({referral_code_param:null},e)},t[n].transaction=function(e,o,i,r,a){t[n].conversion(e,o,i,r,a)};try{a=m().tap_test||l.read("tap_debug").length}catch(b){a=!1}var f=function(){l.write("tap_debug","true",{},(function(){}));var t=document.createElement("script");t.setAttribute("src","https://script.tapfiliate.com/tapfiliate-debug.js"),t.setAttribute("async",!0),document.body.appendChild(t)};!function(){if(a){var o=!1;function i(){!o&&-1<["interactive","complete"].indexOf(document.readyState)&&(o=!0,f())}return document.addEventListener("readystatechange",i),window.addEventListener("load",i),i()}var r;e.reverse();for(var c=e.length-1;0<=c;c--){var s=e[c][0];"create"===s&&r||(t[n].apply(window,e[c]),e.splice(c,1),"create"===s&&(r=!0))}}()}function d(t,n,e){t.addEventListener?t.addEventListener(n,e,!1):t.attachEvent&&t.attachEvent("on"+n,e)}function v(t,n,e){var o,i,r,a;if(a=/\[\]$/,n instanceof Array)for(i=0,r=n.length;i<r;i++)a.test(t)?e(t,n[i]):v(t+"["+("object"==typeof n[i]?i:"")+"]",n[i],e);else if("object"==typeof n)for(o in n)v(t+"["+o+"]",n[o],e);else e(t,n)}function h(t,n,e,o){(n=function(t){for(var n in t)void 0===t[n]&&delete t[n];return t}(n)).sv="tap-v3"+(s.hasMethod("3pCookie")?"-3p":"");var i=t+"?"+c(n),r="GET"===(e=e||(2083<i.length?"POST":"GET"))?i:t;n="POST"===e?JSON.stringify(n):null;var a=new XMLHttpRequest;if("withCredentials"in a)a.open(e,r,!0);else{if("undefined"==typeof XDomainRequest)return;var l=function(){};(a=new XDomainRequest).onerror=l,a.ontimeout=l,a.onprogress=l,a.onload=function(){"function"==typeof o&&o(a,!0)},a.timeout=9e3,a.open(e,r)}a.onreadystatechange=function(){a.readyState<4||(200===a.status?4===a.readyState&&"function"==typeof o&&o(a,!0):"function"==typeof o&&o(a,!1))},a.send(n)}function m(){var t={},n=function(t){return decodeURIComponent(t.replace(/\+/g," "))},e=location.search.substring(1),o=location.hash.substring(1),i=e.split("&");for(var r in i=i.concat(o.split("&")))if(i.hasOwnProperty(r)){var a=i[r].toString().split("=");1<a.length&&(t[n(a[0])]=n(a[1]))}return t}function k(){return o}function y(){k()&&!a&&(t[n].Click.flushQueue(),t[n].Conversion.flushQueue(),t[n].Customer.flushQueue())}function C(e){t[n].vid=e.sort()[0],t[n].vids=e,o=!0}function g(){if(t[n].vids){for(var e=[],o=t[n].vids.length-1;0<=o;o--){var i=t[n].vids[o];i&&-1===e.indexOf(i)&&e.push(i)}if(e.length)return e}}function b(t,n){return this.key=t,this.options=n||{},this.setOption=function(t,n){this.options[t]=n},this}function w(){return this.constructor.apply(this,arguments),this.callbacks={},this}function _(t,n,e){if("function"==typeof e)return 1==n.always_callback?e(t):!0===n.alwaysFireCb?e(null,"error",t):void 0}}();