/*! jquery.iframetracker v2.1.0 | https://github.com/vincepare/iframeTracker-jquery | Copyright (c) 2013-2018 Vincent Par√© | Licensed Apache-2.0 */
!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],(function(e){return t(e)})):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,(function(e){!function(e){e.fn.iframeTracker=function(t){"function"==typeof t&&(t={blurCallback:t});var i=this.get();if(null===t||!1===t)e.iframeTracker.untrack(i);else{if("object"!=typeof t)throw new Error("Wrong handler type (must be an object, or null|false to untrack)");e.iframeTracker.track(i,t)}return this},e.iframeTracker={focusRetriever:null,focusRetrieved:!1,handlersList:[],isIE8AndOlder:!1,init:function(){try{!0===e.browser.msie&&e.browser.version<9&&(this.isIE8AndOlder=!0)}catch(e){try{navigator.userAgent.match(/(msie) ([\w.]+)/i)[2]<9&&(this.isIE8AndOlder=!0)}catch(e){}}if(e(window).focus(),e(window).blur((function(t){e.iframeTracker.windowLoseFocus(t)})),e("body").append('<div style="position:fixed; top:0; left:0; overflow:hidden;"><input style="position:absolute; left:-300px;" type="text" value="" id="focus_retriever" readonly="true" /></div>'),this.focusRetriever=e("#focus_retriever"),this.focusRetrieved=!1,this.isIE8AndOlder){this.focusRetriever.blur((function(t){t.stopPropagation(),t.preventDefault(),e.iframeTracker.windowLoseFocus(t)})),e("body").click((function(t){e(window).focus()})),e("form").click((function(e){e.stopPropagation()}));try{e("body").on("click","form",(function(e){e.stopPropagation()}))}catch(e){console.log("[iframeTracker] Please update jQuery to 1.7 or newer. (exception: "+e.message+")")}}},track:function(t,i){i.target=t,e.iframeTracker.handlersList.push(i),e(t).bind("mouseover",{handler:i},e.iframeTracker.mouseoverListener).bind("mouseout",{handler:i},e.iframeTracker.mouseoutListener)},untrack:function(t){if("function"==typeof Array.prototype.filter){e(t).each((function(t){e(this).unbind("mouseover",e.iframeTracker.mouseoverListener).unbind("mouseout",e.iframeTracker.mouseoutListener)}));var i=function(e){return null!==e};for(var r in this.handlersList){for(var n in this.handlersList[r].target)-1!==e.inArray(this.handlersList[r].target[n],t)&&(this.handlersList[r].target[n]=null);this.handlersList[r].target=this.handlersList[r].target.filter(i),0===this.handlersList[r].target.length&&(this.handlersList[r]=null)}this.handlersList=this.handlersList.filter(i)}else console.log("Your browser doesn't support Array filter, untrack disabled")},mouseoverListener:function(t){t.data.handler.over=!0,e.iframeTracker.retrieveFocus();try{t.data.handler.overCallback(this,t)}catch(e){}},mouseoutListener:function(t){t.data.handler.over=!1,e.iframeTracker.retrieveFocus();try{t.data.handler.outCallback(this,t)}catch(e){}},retrieveFocus:function(){document.activeElement&&"IFRAME"===document.activeElement.tagName&&(e.iframeTracker.focusRetriever.focus(),e.iframeTracker.focusRetrieved=!0)},windowLoseFocus:function(e){for(var t in this.handlersList)if(!0===this.handlersList[t].over)try{this.handlersList[t].blurCallback(e)}catch(e){}}},e(document).ready((function(){e.iframeTracker.init()}))}(e)}));var g17adwatcher={version:"1.7-gdpreventers(quantcast+pw+distro+nm)",debugMode:!1,stage:"init",isFreestarShown:!1,isAttachedPlaywireButton:!1,hasDistroed:!1,playwireButtonHandlerInterval:null,primisButtonHandlerInterval:null,playwireButtonRailHandlerInterval:null,playwireGrace:!0,gdprEventers:[],debugLog:function(e){this.debugMode&&console.log("g17adwatcher: "+e)},init:function(){this.debugLog("g17adwatcher v"+this.version+" started"),window.location.href.indexOf("adwatcher_dbg")>-1&&(this.debugMode=!0,this.debugLog("debug enabled")),this.debugLog("wait for gdpr"),this.changeState("gdpr"),this.onGDPR((function(){window.__tcfapi("getTCData",2,(function(e){window.dataLayer.push({tcfdata:e,cmp:"present",event:"consent_completion"})}))}));var e=function(){for(var e in this.debugLog("gdpr done"),this.gdprEventers)this.gdprEventers[e]();if(!adglobals.shouldShowAds)return this.debugLog("no ads, nothing to monitor"),void this.changeState("off");this.changeState("playwire"),setInterval(this.watcher.bind(this),1e3)}.bind(this);this.waitForGdpr(e),"__noCMP"in window&&window.__noCMP&&e()},makeSureQuantcastLoads:function(){},watcher:function(){this.hasDistroed||this.checkForDistro()},changeState:function(e){this.debugLog("was in state "+this.stage+" now in "+e),"playwire"==e?this.onPlaywire():"playwire"==this.state&&this.offPlaywire(),this.stage=e},onPlaywire:function(){this.playwireButtonHandlerInterval=setInterval(this.checkForPlaywireButton.bind(this),500),this.playwireButtonRailHandlerInterval=setInterval(this.checkForPlaywireRailButton.bind(this),500)},offPlaywire:function(){clearInterval(this.playwireButtonHandlerInterval),clearInterval(this.playwireButtonRailHandlerInterval)},checkForPrimisButton:function(){var e=$("#flow_close_btn_iframe");if(0!=e.length&&"yes"!=e.data("injected")){this.debugLog("injected to primis close");var t=this;e.iframeTracker((function(){t.debugLog("closed primis sticky"),ga&&ga("send","event","Ad","close","Freestar Primis");var e=new Date;e.setTime(e.getTime()+12e4),console.log(e.toGMTString()),ips.utils.cookie.set("hideTrendi2",!0,e.toGMTString())})),e.data("injected","yes")}},checkForPlaywireButton:function(){var e=$("#pw-close-btn");if(0!=e.length&&"yes"!=e.data("injected")){this.debugLog("injected to pw close");e.on("touchstart click",(function(){this.debugLog("closed trendi sticky"),ga&&ga("send","event","Ad","close","Playwire Trendi");var e=new Date;e.setTime(e.getTime()+12e4),console.log(e.toGMTString()),ips.utils.cookie.set("hideTrendi2",!0,e.toGMTString())})),e.data("injected","yes")}},checkForDistro:function(){var e=$("#ds_thumbnail_reel");0!=e.length&&(e.css("background",""),this.hasDistroed=!0)},checkForPlaywireRailButton:function(){var e=$("#pw-oop-bottom_rail").children().eq(1);if(0!=e.length&&"yes"!=e.data("injected")){this.debugLog("injected to pw BR close");var t=this;e.on("touchstart click",(function(){t.debugLog("closed trendi bottom rail"),ga&&ga("send","event","Ad","close","Playwire Bottom Rail");var e=new Date;e.setTime(e.getTime()+12e4),console.log(e.toGMTString()),ips.utils.cookie.set("hideTrendi2",!0,e.toGMTString())})),e.data("injected","yes")}},isPlaywireShowing:function(){return null!==document.getElementById("tyche_corner_video_container")&&"visible"===document.getElementById("tyche_corner_video_container").style.visibility||null!==document.getElementById("tyche_trendi_video_container")&&"visible"===document.getElementById("tyche_trendi_video_container").style.visibility},waitForGdpr:function(e){window.__tcfapi("addEventListener",2,(function(t,i){i&&("useractioncomplete"!==t.eventStatus&&"tcloaded"!==t.eventStatus||e())}))},onGDPR:function(e){"init"==this.stage||"gdpr"==this.stage?this.gdprEventers.push(e):e()}};g17adwatcher.init();